<%= editable_tag(:h1, "test-page-header") %>
<%= editable_tag(:div, "test-page-body") %>

<script>
  /*
  function saveButtonSetup(editor) {
    editor.addButton('save', {
      tooltip: 'Save',
      icon: true,
      image: '/assets/tinymce/save_icon.png',
      onclick: function() {
        var element = $(editor.bodyElement)
          , key = element.data('content-key')
          , locale = element.data('locale')
        ;

        $.ajax('/editor_content', {
          method: "POST",
          data: {
            key: key
            value: editor.getContent(),
            , locale: locale
          },
          error: function() {
            alert("Oops, something went wrong! Please try again later.");
          }
        });
      }
    })
  }
  */

  tinymce.init({
    selector: 'h1[data-editable="true"]',
    inline: true,
    plugins: 'save',
    toolbar: 'undo redo | save',
    save_onsavecallback: function(editor) {
      var element = $(editor.bodyElement)
        , key = element.data('content-key')
        , locale = element.data('locale')
      ;

      $.ajax('/editor_content', {
        method: "POST",
        data: {
          key: key
        , value: editor.getContent()
        , locale: locale
        },
        error: function() {
          alert("Oops, something went wrong! Please try again later.");
        }
      });
    },
    menubar: false
  });

  tinymce.init({
    selector: 'div[data-editable="true"]',
    inline: true,
    toolbar: 'undo redo | bold italic | bullist | save',
    menubar: false,
    setup: function(editor) {
      saveButtonSetup(editor);
    }
  });
</script>

